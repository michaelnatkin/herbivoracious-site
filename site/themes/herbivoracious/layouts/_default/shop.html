{{ define "main" }}
<div class="site-content">
  <main class="main-content">
    <article class="shop-page">
      <header class="single-header">
        <h1>{{ .Title }}</h1>
      </header>

      <div class="shop-intro">
        <p>Over the years of writing Herbivoracious, I've come to rely on certain kitchen tools and specialty ingredients that make vegetarian cooking truly shine. Here are the products I actually use and recommend — many of them are linked from specific recipes throughout the site.</p>
        <p class="shop-disclosure"><em>Disclosure: These are affiliate links. If you purchase through them, I earn a small commission at no extra cost to you. I only recommend products I genuinely use and love.</em></p>
      </div>

      {{ $data := site.Data.products }}

      <nav class="shop-nav" aria-label="Product categories">
        {{ range $data.categories }}
        <a href="#{{ .slug }}">{{ .name }}</a>
        {{ end }}
      </nav>

      {{ range $data.categories }}
      {{ $catName := .name }}
      <section class="shop-section" id="{{ .slug }}">
        {{ with .image }}
        <div class="shop-banner">
          <img src="{{ . }}" alt="{{ $catName }}" loading="lazy">
        </div>
        {{ end }}
        <h2>{{ .name }}</h2>
        {{ with .description }}<p class="shop-section__desc">{{ . }}</p>{{ end }}

        <ul class="shop-list">
          {{ range .products }}
          <li class="shop-item">
            <a href="{{ .url }}" class="shop-item__link" target="_blank" rel="noopener noreferrer nofollow">{{ .name }}</a>
            {{ with .review_url }}
            <a href="{{ . }}" class="shop-item__review">read review →</a>
            {{ end }}
            {{ with .featured_in }}
            <span class="shop-item__featured">
              Featured in:
              {{ range $i, $url := . }}{{ if $i }}, {{ end }}<a href="{{ $url }}">{{ $url | replaceRE `^/\d{4}/\d{2}/` "" | replaceRE `/$` "" | replaceRE `-` " " | title }}</a>{{ end }}
            </span>
            {{ end }}
          </li>
          {{ end }}
        </ul>
      </section>
      {{ end }}
    </article>
  </main>

  {{ partial "sidebar.html" . }}
</div>
{{ end }}
